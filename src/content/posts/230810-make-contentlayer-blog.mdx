---
title: 'Contentlayer ë¸”ë¡œê·¸ ë§Œë“¤ê¸°'
description: 'Next.jsì™€ Contentlayerë¥¼ ì‚¬ìš©í•œ ë¸”ë¡œê·¸ í…œí”Œë¦¿ êµ¬í˜„ í›„ê¸°'
cover: '../../assets/blog-placeholder.jpg'
publishedDate: 2023-08-10
category: 'Tech'
author: 'woongsnote'
tags: [Nextjs, TypeScript, Contentlayer]
slug: 'make-contentlayer-blog'
---

Next.jsì™€ ContentLayerë¡œ ë¸”ë¡œê·¸ë¡œ ë§Œë“¤ì—ˆë˜ ê³¼ì •ì„ `Blog template`ì„ ë§Œë“¤ë©´ì„œ, ì •ë¦¬í•´ë³´ë ¤ê³  í•œë‹¤.

## âš’ï¸ ê¸°ìˆ  ìŠ¤íƒ

ì•„ë˜ ê¸°ìˆ ë“¤ì„ ë² ì´ìŠ¤ë¡œ ì‚¬ìš©í•´ì„œ ì œì‘í–ˆë‹¤.

- `Next.js` , `TypeScript`, `TailwindCSS`, `ContentLayer`

## âŒ¨ï¸ê°œë°œ ê³¼ì •

### í”„ë¡œì íŠ¸ ìƒì„±

```bash title="í”„ë¡œì íŠ¸ ìƒì„±"
npx create-next-app@latest
```

```bash title="ì„¸ë¶€ ì„¤ì •"
What is your project named? mdx-blog
Would you like to use TypeScript? No / **Yes**
Would you like to use ESLint? No / **Yes**
Would you like to use Tailwind CSS? No / **Yes**
Would you like to use `src/` directory? **No** / Yes
Would you like to use App Router? (recommended) No / **Yes**
Would you like to customize the default import alias? **No** / Yes
```

### Contentlayer ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜

    ```bash title="ë¼ì´ë¸ŒëŸ¬ë¦¬"
    npm install contentlayer next-contentlayer date-fns
    ```

### ContentLayer ì„¤ì •í•˜ê¸°

- ContentLayerë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´, `next.config.js` , `tsconfig.json` , ìˆ˜ì •ì´ í•„ìš”í•˜ë‹¤.

1. **next.config.js**

```jsx title="next.config.js"

**import { withContentlayer } from "next-contentlayer";**
/** @type {import('next').NextConfig} */
const nextConfig = {
  **reactStrictMode: true,
  swcMinify: true,**
};

**module.exports = withContentlayer(nextConfig);**
```

2. **tsconfig.json**

```json title="tsconfig.json"
{
  "compilerOptions": {
    "target": "es5",
    "lib": ["dom", "dom.iterable", "esnext"],
    "allowJs": true,
    "skipLibCheck": true,
    "strict": true,
    "forceConsistentCasingInFileNames": true,
    "noEmit": true,
    "esModuleInterop": true,
    "module": "esnext",
    "moduleResolution": "bundler",
    "resolveJsonModule": true,
    "isolatedModules": true,
    "jsx": "preserve",
    "incremental": true,
    "plugins": [
      {
        "name": "next"
      }
    ],
    "baseUrl": ".",
    "paths": {
      "@/*": ["./*"],
      "contentlayer/generated": ["./.contentlayer/generated"]
    }
  },
  "include": [
    "next-env.d.ts",
    "**/*.ts",
    "**/*.tsx",
    ".next/types/**/*.ts",
    ".contentlayer/generated"
  ],
  "exclude": ["node_modules"]
}
```

ì¶”ê°€ë¡œ, ë¡œì»¬ì—ì„œ ë¹Œë“œí•œ ê²°ê³¼ë¬¼ì€ `GitHub`ì— ì˜¬ë¼ê°€ì§€ ì•Šë„ë¡, `.gitignore` íŒŒì¼ì— ì•„ë˜ ë‚´ìš©ì„ ì¶”ê°€í•œë‹¤

```.gitignore title=".gitignore"
# contentlayer
.contentlayer
```

ì´ì œ ë£¨íŠ¸(ìµœìƒë‹¨) ë””ë ‰í† ë¦¬ì— `contentlayer.config.ts` íŒŒì¼ì„ ë§Œë“¤ì–´ì•¼ í•œë‹¤.

ì§ì ‘ ë§Œë“¤ì–´ë„ ë˜ê³ , í„°ë¯¸ë„ì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¡œ ìƒì„±í•  ìˆ˜ë„ ìˆë‹¤.

```bash
touch contentlayer.config.ts
```

contentlayer.config.ts íŒŒì¼ì˜ êµ¬ì„±ì€ ì•„ë˜ì™€ ê°™ë‹¤

```tsx title="contentlayer.config.ts"
import { defineDocumentType, makeSource } from 'contentlayer/source-files';

export const Post = defineDocumentType(() => ({
  name: 'Post',
  filePathPattern: `**/*.mdx`,
  contentType: 'mdx',
  fields: {
    title: {
      type: 'string',
      required: true,
    },
    date: {
      type: 'date',
      required: true,
    },
  },
  computedFields: {
    url: {
      type: 'string',
      resolve: (post) => `/posts/${post._raw.flattenedPath}`,
    },
  },
}));

export default makeSource({ contentDirPath: 'posts', documentTypes: [Post] });
```

ì´ì œ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— posts í´ë”ë¥¼ ìƒì„±í•˜ê³ , ê²Œì‹œê¸€ì„ ì‘ì„±í•´ì¤€ë‹¤.

posts í´ë”ì¸ ì´ìœ ëŠ” `contentDirPath: "posts"` ë¡œ ì„¤ì •í–ˆê¸° ë•Œë¬¸ì´ë‹¤.

```markdown
---
title: My First Post
date: 2023-08-10
---

This is My First Post!! :)
```

ê²Œì‹œê¸€ì„ ë‚ ì§œìˆœìœ¼ë¡œ ë³´ì—¬ì£¼ê¸° ìœ„í•´, ì„œë¡œ ë‹¤ë¥¸ ë‚ ì§œë¡œ ì„¤ì •í•œ ê²Œì‹œê¸€ë“¤ì„ ìƒì„±í•´ì¤€ë‹¤.

```md
---
title: My First Post
date: 2023-08-08
---

## Test 1

This is My First Post ğŸ˜€ Ha Ha Ha
```

```md
---
title: My Second Post
date: 2023-08-09
---

## Test 2

This is My Second Post ğŸ˜€ Ha Ha Ha
```

```md
---
title: My Third Post
date: 2023-08-10
---

## Test 3

This is My Third Post ğŸ˜€ Ha Ha Ha
```

ê²Œì‹œê¸€ê¹Œì§€ ì‘ì„±í–ˆìœ¼ë©´, ê²Œì‹œê¸€ì„ ë³´ì—¬ì£¼ê¸° ìœ„í•´ í™ˆí˜ì´ì§€(app ë””ë ‰í† ë¦¬ì˜ `page.tsx`)
ë¥¼ ìˆ˜ì •í•´ì•¼ í•œë‹¤.

```tsx title="app/page.tsx"
import { allPosts } from '@/.contentlayer/generated';
import { compareDesc } from 'date-fns';

export default function Home() {
  const posts = allPosts.sort((a, b) =>
    compareDesc(new Date(a.date), new Date(b.date))
  );

  return (
    <div>
      {posts.map((post) => (
        <h2 key={post._id}>{post.title}</h2>
      ))}
    </div>
  );
}
```

ì‘ì„±í•œ ê²Œì‹œê¸€ ì œëª©ë“¤ì˜ ëª©ë¡ì´ ë³´ì¼ ê²ƒì´ë‹¤.

ì´ì œ ì œëª©ë§Œ ë³´ì—¬ì£¼ëŠ” ëŒ€ì‹  ê° í¬ìŠ¤íŠ¸ë¥¼ ë³´ì—¬ì¤„ ì»´í¬ë„ŒíŠ¸ë¡œ ë§Œë“¤ì–´ì„œ ì¢€ ë” ê¾¸ë©°ë³´ë„ë¡ í•˜ì.

app ë””ë ‰í† ë¦¬ì— `components` í´ë”ë¥¼ ìƒì„±í•˜ê³ , `PostCard.tsx` íŒŒì¼ì„ ìƒì„±í•œë‹¤.

```tsx title="components/PostCard.tsx"
import { Post } from '@/.contentlayer/generated';
import { format, parseISO } from 'date-fns';
import Link from 'next/link';

export default function PostCard(post: Post): React.ReactElement {
  return (
    <div className="mb-4 flex flex-col rounded-lg border-2 p-2">
      <Link href={post.url} className="mb-1 text-3xl text-blue-500">
        {post.title}
      </Link>
      <time dateTime={post.date}>
        {format(parseISO(post.date), 'LLLL d, yyyy')}
      </time>
    </div>
  );
}
```

page.tsxì—ë„ ì œëª©ì„ ì¶”ê°€í•˜ê³ , ìŠ¤íƒ€ì¼ì„ ì¶”ê°€í•˜ë„ë¡ í•˜ì.

```tsx title="app/page.tsx"
import { allPosts } from '@/.contentlayer/generated';
import { compareDesc } from 'date-fns';
import PostCard from './components/PostCard';

export default function Home() {
  const posts = allPosts.sort((a, b) =>
    compareDesc(new Date(a.date), new Date(b.date))
  );

  return (
    <main className="mx-auto max-w-5xl">
      <h1 className="my-8 text-center text-3xl font-bold">
        Next.js & ContentLayer Blog Example
      </h1>
      {posts.map((post) => (
        <PostCard key={post._id} {...post} />
      ))}
    </main>
  );
}
```

ì•„ì§, ìƒì„¸ í˜ì´ì§€ì— ëŒ€í•œ ì½”ë“œë¥¼ ì‘ì„±í•˜ì§€ ì•Šì•„ì„œ, ê° Postë¥¼ í´ë¦­í•˜ë©´ **404 í˜ì´ì§€**ë¥¼ ë§Œë‚˜ê²Œ ë  ê²ƒì´ë‹¤.

ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ **ìƒì„¸ í˜ì´ì§€**ë¥¼ êµ¬í˜„í•œë‹¤.

```tsx title="app/[slug]/page.tsx"
import { allPosts } from '@/.contentlayer/generated';
import { notFound } from 'next/navigation';
import type { MDXComponents } from 'mdx/types';
import Link from 'next/link';
import { useMDXComponent } from 'next-contentlayer/hooks';

const mdxComponents: MDXComponents = {
  a: ({ href, children }) => <Link href={href as string}>{children}</Link>,
};

export const generatedStaticParams = async () => {
  allPosts.map((post) => ({ slug: post._raw.flattenedPath }));
};

export const generatedMetadata = ({ params }: { params: { slug: string } }) => {
  const post = allPosts.find((post) => post._raw.flattenedPath === params.slug);
  if (!post) notFound();
};

export default function PostPage({ params }: { params: { slug: string } }) {
  const post = allPosts.find((post) => post._raw.flattenedPath === params.slug);
  if (!post) notFound();

  const MDXContent = useMDXComponent(post.body.code);

  return (
    <article className="prose mx-auto">
      <div className="mb-8 text-center">
        <time dateTime={post.date} className="mb-1 text-xs text-gray-600">
          {new Intl.DateTimeFormat('en-US').format(new Date(post.date))}
        </time>
        <h1 className="text-3xl font-bold">{post.title}</h1>
      </div>
      <MDXContent components={mdxComponents} />
    </article>
  );
}
```

â€» Next.jsì—ì„œ ì œê³µí•´ì£¼ëŠ” 404 í˜ì´ì§€ê°€ ë§ˆìŒì— ë“¤ì§€ ì•Šì•„ ì»¤ìŠ¤í…€í•˜ê³  ì‹¶ì€ ê²½ìš°, app ë””ë ‰í† ë¦¬ì— `not-found.tsx` íŒŒì¼ë¡œ 404 í˜ì´ì§€ë¥¼ ì§ì ‘ êµ¬í˜„í•  ìˆ˜ë„ ìˆë‹¤.

- `not-found.tsx` íŒŒì¼ì´ posts í´ë” ì•ˆì— ìˆëŠ” ê²½ìš°, /posts í•˜ìœ„ ê²½ë¡œì—ë§Œ ë™ì‘í•˜ê³ , ê·¸ ì™¸ì˜ ê²½ìš°ëŠ” app ë””ë ‰í† ë¦¬ì˜ `not-found.tsx`ê°€ ë™ì‘í•œë‹¤.

```tsx title="app/not-found.tsx"
import Link from 'next/link';

export default function NotFound(): React.ReactElement {
  return (
    <div className="mx-auto my-20 flex max-w-4xl flex-col items-center justify-center">
      <h1 className="mb-10 text-center text-3xl text-orange-500">
        This Link is Not Valid
      </h1>
      <Link href="/" className="text-center text-blue-500">
        Go Home
      </Link>
    </div>
  );
}
```

â€» articleì˜ styleì„ ì‰½ê²Œ í•˜ê¸° ìœ„í•´, \***\*`@tailwindcss/typography` ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.**

ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì€ ì•„ë˜ ëª…ë ¹ì–´ë¡œ ì„¤ì¹˜í•˜ê³ ,

```tsx
npm install -D @tailwindcss/typography
```

**`tailwind.config.js` ì— í•´ë‹¹ í”ŒëŸ¬ê·¸ì¸ì„ ì¶”ê°€í•´ì¤€ë‹¤.**

```js title="tailwind.config.js"
module.exports = {
  theme: {
    // ...
  },
  plugins: [
    **require('@tailwindcss/typography'),**
    // ...
  ],
}
```

ì™„ë£Œë˜ë©´ `<article>` ì˜ classNameì— `prose`ë¥¼ ì¶”ê°€í•´ì£¼ë©´ ëœë‹¤!

```tsx
<article className="prose mx-auto"> ... </article>
```

êµ¬í˜„í•œ ì „ì²´ í…œí”Œë¦¿ì€ ì•„ë˜ ë§í¬ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

- [ë°”ë¡œê°€ê¸°](https://github.com/woongsnote/contentlayer-blog-template)
