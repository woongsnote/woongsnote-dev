---
import SearchIcon from '@/shared/assets/icons/search.svg';

const kbdStyle = `bg-background/40 inline-flex items-center rounded-full border border-none px-1.5 py-0.5 font-sans text-xs/4 leading-none`;
---

<!-- Mobile -->
<button
  type="button"
  data-search-open
  aria-label="검색 (Ctrl 또는 ⌘ + K)"
  class="text-sub hover:bg-secondary/50 focus-visible:ring-accent inline-flex items-center justify-center rounded-md focus-visible:ring-2 focus-visible:outline-none sm:hidden"
>
  <SearchIcon class="size-5" />
</button>

<!-- Desktop chip -->
<button
  type="button"
  data-search-open
  aria-label="검색 열기 (⌘ + K)"
  class="border-divider/40 bg-background/60 text-sub hover:bg-background/50 hover:border-divider/60 focus-visible:ring-accent hidden items-center rounded-full border px-2 py-1 focus-visible:ring-2 focus-visible:outline-none sm:inline-flex"
>
  <SearchIcon class="size-4 opacity-70" />
  <kbd class={`${kbdStyle} kdb-mac`}> ⌘K </kbd>
</button>
<script>
  // 속성 없는 script => 번들링 OK
  const btn = document.querySelector('[data-search-open]');
  btn?.addEventListener('click', () => {
    // 모달이 data-search-modal이므로, 열기만 토글(간단)
    const root = document.querySelector('[data-search-modal]');
    if (!(root instanceof HTMLElement)) return;
    root.classList.remove('hidden');
    root.setAttribute('aria-hidden', 'false');
    const input = root.querySelector('[data-search-input]');
    if (input instanceof HTMLInputElement) queueMicrotask(() => input.focus());
  });
</script>
