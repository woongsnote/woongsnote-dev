---
import { type CollectionEntry, getCollection } from 'astro:content';
import Layout from '@layouts/BaseLayout.astro';
import BlogHeader from '@components/Blog/BlogHeader.astro';
import YearList from '@components/Blog/YearList.astro';
import { sortPostsByDateDesc, generateYears } from '@utils/data-util';
import { BLOG } from '@config/site-config';

const { title, description } = BLOG;

const allPosts: CollectionEntry<'blog'>[] = await getCollection('blog');

const sortedPosts: CollectionEntry<'blog'>[] =
  allPosts.sort(sortPostsByDateDesc);

const years: string[] = generateYears(sortedPosts);
---

<Layout title={title} description={description}>
  <BlogHeader />
  <YearList years={years} />
</Layout>
