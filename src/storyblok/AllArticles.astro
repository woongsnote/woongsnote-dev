---
import ArticleCard from '@components/ArticleCard.astro';
import PageTitle from '@components/PageTitle.astro';
import { storyblokEditable, useStoryblokApi } from '@storyblok/astro';

const { blok } = Astro.props;

const storyblokApi = useStoryblokApi();
const { data } = await storyblokApi.get(`cdn/stories`, {
  version: 'draft', // or 'published'
  starts_with: 'blog/',
  is_startpage: false,
});

const articles = data.stories;
console.log(articles);
---

<section class="" {...storyblokEditable(blok)}>
  <PageTitle title={blok.headline}/>

  <ul class="grid grid-cols-1 gap-6 md:grid-cols-3">
    {
      articles?.length &&
        articles.map((article: any) => {
          article.content.slug = article.slug;
          return (
            <li>
              <ArticleCard article={article.content} />
            </li>
          );
        })
    }
  </ul>
</section>
