---
title: useRef와 forwardRef
description: ref를 전달하는 방법
date: 2023-08-21
tags:
  - title: React
  - title: forwardRef
category: Tech
---

## 개요

프로젝트를 진행하면서, 부모 컴포넌트가 자식 컴포넌트의 DOM Element에 접근해야 하는 상황이 생겼다.
이를 해결하는 방법으로 `forwardRef`를 알게 되서 `useRef`와 함께 정리하려고 한다.

## useRef란?

**useRef**는 React Hooks 중의 하나로, 컴포넌트에서 DOM 요소에 직접 접근하는데 사용된다.
이전에는 클래스 컴포넌트에서 ref를 사용해서 DOM 요소에 접근할 수 있었지만, 함수형 컴포넌트에서는 useRef가 이를 대체하는 방식으로 사용된다.
useRef의 가장 중요한 특징은 컴포넌트 리렌더링과 관계없이 항상 일관된 값을 가진다는 것이다.
이는 상태를 관리하지 않고도 DOM 요소의 상태를 저장하고 유지할 수 있게 해준다.

## forwardRef란?

**forwardRef**는 하위 컴포넌트로 ref를 전달할 때 사용된다.
컴포넌트는 기본적으로 props를 받아와서 처리하지만, ref는 props에 속하지 않아 자동으로 컴포넌트로 전달되지 않는다.
이 때, forwardRef를 사용해서 ref를 전달할 수 있다.

자식 컴포넌트에서 ref의 타입을 `RefObject`로 지정하게 되면, **Type Error**가 발생하게 된다.
이를 해결하는 방법은 ref의 타입을 `ForwardedRef`로 지정하는 것이다.

위 내용들을 코드로 정리하면, 아래와 같다.

### useRef와 forwardRef를 활용한 React 컴포넌트 예시

1. Parent Component

   ```tsx
   import { useRef } from 'react';
   import Preview from './Preview';

   export default function ParentComponent() {
     const divRef = useRef<HTMLDivElement>(null);

     return (
       <>
         {/* ... */}
         <ChildComponent
           title={inputValues.title}
           subTitle={inputValues.subTitle}
           tag={inputValues.tag}
           backgroundStyle={backgroundStyle}
           ref={divImageRef}
         />
         {/* ... */}
       </>
     );
   }
   ```

2. Child Component

   ```tsx
   import { ForwardedRef, forwardRef } from 'react';

   interface IChildProps {
     title: string;
     subTitle: string;
     tag: string;
     backgroundStyle: React.CSSProperties;
   }

   function ChildComponent(
     { title, subTitle, tag, backgroundStyle }: IChildProps,
     ref: ForwardedRef<HTMLDivElement>,
   ) {
     return (
       <div
         className="w-full max-w-3xl h-96 mx-auto flex flex-col justify-between text-center"
         style={backgroundStyle}
         ref={ref}
       >
         <div className="h-3/4 justify-center flex flex-col ">
           <h1 className="text-4xl mb-2">{title || '제목을 입력하세요'}</h1>
           <h2 className="text-2xl w-fit mx-auto mt-1">
             {subTitle || '부제목을 입력하세요'}
           </h2>
         </div>
         <p className="w-full h-auto mb-2">{tag || '태그를 입력하세요'}</p>
       </div>
     );
   }

   export default forwardRef<HTMLDivElement, ImagePreviewProps>(ChildComponent);
   ```

---

### 참고

- [예시 컴포넌트를 사용한 프로젝트](https://github.com/woongsnote/image-generator)
