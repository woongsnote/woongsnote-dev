---
title: React에서의 Hydration
description: React에서의 Hydration에 관한 설명
date: 2023-08-14
tags:
  - title: React
  - title: Hydration
---

## 개요

React에서의 Hydration이라는 개념에 대해 알아보려고 한다.

## Hydration이란?

**Hydration**이란 서버 사이드 렌더링(SSR)을 사용하는 React 애플리케이션에서 클라이언트 사이드에서 추가적인 작업을 수행하는 과정을 말한다.
SSR은 초기 로딩 속도를 향상시키고 SEO를 개선하기 위해 사용되는 기술이다.
SSR을 사용하면 서버에서 HTML을 생성하여 클라이언트에게 전송하고, 클라이언트에서는 이 HTML을 그대로 화면에 표시한다.
하지만 이렇게만 하면 React의 장점인 상호작용성(interactivity)을 잃게 된다.

따라서 클라이언트에서는 서버에서 생성한 HTML에 React 컴포넌트를 연결(attach)하고 이벤트 리스너를 등록하는 작업이 필요한데, 이 작업을 Hydration이라고 부른다.

Hydration은 React가 서버와 클라이언트에서 동일한 HTML을 생성할 수 있도록 요구한다.
만약, 서버와 클라이언트에서 다른 **HTML**을 생성하면 Hydration 과정에서 오류가 발생할 수 있다.

- Ex) 서버에서는 `<div id="root">Hello</div>`라는 HTML을 생성했는데, 클라이언트에서는 `<div id="root">World</div>`라는 HTML을 생성한다면, React는 이 두 HTML을 일치시키기 위해 DOM을 수정하게 된다. 이렇게 되면 Hydration의 성능과 정확성이 저하될 수 있다.

또한, 서버와 클라이언트에서 다른 상태(state)나 속성(props)를 사용하면 Hydration 과정에서 경고(warning)가 발생할 수 있다.

- Ex) 서버에서는 `<Clock date={new Date()}/>`라는 컴포넌트를 렌더링했는데, 클라이언트에서는 `<Clock date={null}/>`라는 컴포넌트를 렌더링한다면, React는 이 두 컴포넌트의 속성이 다르다고 경고하게 된다. 
이러한 경고는 Hydration의 결과에 영향을 주지 않지만, 개발자가 의도하지 않은 동작을 알려주기 위한 것이다.

Hydration은 React 애플리케이션의 성능과 사용자 경험에 중요한 영향을 미친다.
Hydration이 늦게 일어나면 사용자가 화면에 표시된 요소를 클릭하거나 입력하려고 할 때 반응이 없거나 지연되어, 사용자 경험에 좋지 않다.

따라서 Hydration을 최대한 빠르게 수행하기 위해 몇 가지 방법을 사용할 수 있다.

### Hydration을 빠르게 수행하기 위한 방법들

1. 코드 스플리팅(code splitting)

코드 스플리팅을 사용하여 필요한 코드만 로드하고 실행할 수 있다.
예를 들어, React.lazy와 Suspense를 사용하여 동적으로 컴포넌트를 로드하고 Hydration할 수 있다.

2. Progressive Hydration

Progressive Hydration을 사용하여 우선순위에 따라 컴포넌트를 순차적으로 Hydration할 수 있다.
예를 들어, react-dom/hydrate와 react-dom/unstable_createRoot를 사용하여 비동기적으로 컴포넌트를 Hydration할 수 있다.

## 결론

Hydration은 React에서 SSR을 사용하는 경우 반드시 알아야 하는 개념으로, Hydration을 이해하고 적절하게 사용하면 React 애플리케이션의 성능과 사용자 경험을 향상시킬 수 있다.
